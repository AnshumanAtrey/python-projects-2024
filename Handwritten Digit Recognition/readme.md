# Handwritten Digit Classification

This project implements a Convolutional Neural Network (CNN) to classify handwritten digits from the MNIST dataset. The model is built using PyTorch and provides insights into its interpretability by visualizing the learned features. Additionally, the model outputs the probability distribution of the predicted digits for each input image.

### Table of Contents

- [Project Overview](#project-overview)
- [Features](#features)
- [Technologies Used](#technologies-used)
- [Installation and Setup](#installation-and-setup)
- [Model Architecture](#model-architecture)
- [Dataset](#dataset)
- [Training the Model](#training-the-model)
- [Prediction and Interpretability](#prediction-and-interpretability)
- [Gunicorn Configuration](#gunicorn-configuration)

---

## Project Overview

This project uses a custom CNN to classify digits from the MNIST dataset. It offers an interface to input images, get predictions, and visualize the probability distribution and the interpretability map generated by the network's convolutional layers.

The goal is not only to provide accurate predictions but also to explain how the model makes decisions by visualizing the intermediate feature maps learned by the CNN.

---

## Features

1. **Digit Classification**: Predicts digits (0-9) from the input images.
2. **Probability Distribution**: Displays the probability for each class.
3. **Interpretability**: Visualizes learned features from the convolutional layers.
4. **Test Integration**: Basic unit tests to verify the functionality of the app.
5. **REST API**: A simple API to submit images for predictions.

---

## Technologies Used

- **Python 3.7+**
- **PyTorch**: Deep learning framework.
- **Flask**: Web framework for serving the model.
- **Gunicorn**: WSGI HTTP Server for deployment.
- **Numpy, Pandas, Matplotlib**: For data processing and visualization.

---

## Installation and Setup

### Prerequisites

- Python 3.7+
- Pip

### Steps



1. Install the required packages.
   ```bash
   pip install -r requirements.txt
   ```


   
2. Run the Flask app locally:
   ```bash
   python app.py
   ```

---

## Model Architecture

The model is a custom CNN with the following layers:

- **Convolutional Layers**: Two blocks of two convolutional layers each, followed by ReLU activations and MaxPooling.
- **Fully Connected Layers**: One fully connected layer followed by a softmax layer.
- **Dropout Layers**: Added after pooling layers to prevent overfitting.

---

## Dataset

The dataset used is the **MNIST handwritten digits dataset**. It consists of 60,000 training samples and 10,000 testing samples. Each image is a 28x28 grayscale image representing a single digit between 0 and 9.

---

## Training the Model

The training script is located in `train.py`. To train the model:

1. Adjust hyperparameters (learning rate, batch size, epochs) in the `Args` class in the `train.py` script.
2. Run the script to start training.
   ```bash
   python train.py
   ```

The model weights will be saved in the `checkpoint/` directory after training.

---

## Prediction and Interpretability

### REST API

To get predictions and interpretability images, use the `/process` endpoint.

- Input: Base64-encoded image of a digit.
- Output: Predicted digit, probability distribution image, and interpretability image.


### Output

- Predicted digit.
- Probability distribution image (as Base64).
- Learned feature maps image (as Base64).

---


## Gunicorn Configuration

For production deployment, the app is configured to run using **Gunicorn**.

- Configuration file: `config.py`
- Workers: Number of workers is determined by the CPU count.

Run Gunicorn with:
```bash
gunicorn --config config.py app:app
```

--- 

## Future Improvements

- **Advanced Interpretability**: Implement more sophisticated interpretability techniques such as Grad-CAM.
- **Web Interface**: Develop a more interactive web UI for uploading images and visualizing predictions.
- **Model Performance**: Experiment with more advanced architectures such as ResNet or EfficientNet.

--- 
